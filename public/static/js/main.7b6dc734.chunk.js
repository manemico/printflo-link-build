(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(55),s=n.n(a),o=n(18),i=n(38),l=n(146),j=n(145),u=n(30),b=n(16),d=n(9),p=n(1),O=r.a.memo((function(e){var t=e.collapsed,n=e.toggled,c=e.handleToggleSidebar,r=e.handleCollapsedChange,a=Object(d.f)().pathname,s=Object(j.a)();return Object(p.jsxs)(u.c,{collapsed:t,toggled:n,breakPoint:"md",onToggle:c,children:[Object(p.jsx)(u.f,{children:Object(p.jsx)("div",{style:{padding:"24px",textTransform:"uppercase",fontWeight:400,fontSize:"20px",letterSpacing:"2px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:Object(p.jsx)(b.f,{})})}),Object(p.jsx)(u.d,{children:Object(p.jsx)(u.a,{iconShape:"circle",children:Object(p.jsxs)(u.b,{icon:Object(p.jsx)(b.d,{}),active:a.includes("/"),children:[s.formatMessage({id:"configVars"}),Object(p.jsx)(i.b,{to:"/"})]})})}),Object(p.jsx)(u.e,{style:{textAlign:"center"},children:Object(p.jsx)("div",{className:"sidebar-btn-wrapper",style:{padding:"20px 24px"},children:Object(p.jsx)("span",{className:"sidebar-btn",onClick:function(){return r(t)},role:"button",children:t?Object(p.jsx)(b.b,{}):Object(p.jsx)(b.a,{})})})})]})})),h=n(147),f=n(44),x=n(43),g=n(59),v=n(32),m=n.n(v),y=n(47),k=n(46),C=n.n(k),S=n(148),w=n(149),N=n(60),V=n.n(N);function A(){return new Promise(function(){var e=Object(y.a)(m.a.mark((function e(t,n){var c,r,a,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="".concat("/api","/config-vars"),r=new AbortController,a=r.signal,e.prev=3,e.next=6,fetch(c,{method:"get",signal:a});case 6:(s=e.sent).cancel=function(){return r.abort()},setTimeout((function(){t(s.json())}),2e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),console.log("fetchConfigVars error",e.t0),n(e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t,n){return e.apply(this,arguments)}}())}function T(e){return new Promise(function(){var t=Object(y.a)(m.a.mark((function t(n,c){var r,a,s,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="".concat("/api","/config-vars/update"),a=new AbortController,s=a.signal,t.prev=3,t.next=6,fetch(r,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:s});case 6:(o=t.sent).cancel=function(){return a.abort()},setTimeout((function(){n(o.json())}),2e3),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.log("fetchConfigVars error",t.t0),c(t.t0);case 15:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e,n){return t.apply(this,arguments)}}())}function E(){var e=Object(S.a)("configVars",A),t=e.isLoading,n=e.isError,r=e.error,a=e.data,s=Object(f.b)(),i=Object(c.useState)(!1),l=Object(o.a)(i,2),j=l[0],u=l[1],d=Object(c.useState)(""),O=Object(o.a)(d,2),h=O[0],v=O[1],k=Object(c.useRef)(),N=Object(w.a)(function(){var e=Object(y.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("config in useMutation",t),e.next=3,T(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onMutate:function(e){console.log("> onMutate init"),s.cancelQueries("configVars");var t=s.getQueryData("configVars");return s.setQueryData("configVars",(function(t){var n=e.key,c=e.value;return console.log("old configVars",t),Object(g.a)(Object(g.a)({},t),{},Object(x.a)({},n,c))})),{previousConfigvars:t}},onSuccess:function(e){console.log("> onSuccess init"),console.log("data: ",e)},onError:function(e,t,n){console.log("> onError init"),console.log("onError::error: ",e),console.log("onError::context: ",n),s.setQueryData(n.previousConfigvars)},onSettled:function(){s.invalidateQueries("configVars")}});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"page-title",children:[Object(p.jsx)("h1",{children:"Config Vars"}),Object(p.jsx)("p",{className:"page-description",children:"Config vars change the way your app behaves."})]}),Object(p.jsx)("section",{children:t?Object(p.jsx)(C.a,{count:10,height:50,circle:!0}):n?Object(p.jsx)("div",{className:"warn",children:Object(p.jsx)("pre",{children:JSON.stringify(r,null,2)})}):Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("table",{children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"Key"}),Object(p.jsx)("th",{children:"Value"}),Object(p.jsx)("th",{children:"Action"})]})}),Object(p.jsx)("tbody",{children:Object.keys(a).map((function(e,t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e}),Object(p.jsx)("td",{children:a[e]}),Object(p.jsx)("td",{style:{textAlign:"center"},children:Object(p.jsx)("button",{onClick:function(){return function(e){var t=e.key,n=e.value;u(!0),v((function(){return{key:t,value:n}}))}({key:e,value:a[e]})},children:Object(p.jsx)(b.c,{})})})]},t)}))})]})})}),Object(p.jsx)(V.a,{isOpen:j,onAfterOpen:function(){console.log(">> modal opened"),k.current.focus()},onRequestClose:function(){u(!1)},className:"modal-content",overlayClassName:"modal-overlay",contentLabel:"Edit Config Var Modal",closeTimeoutMS:500,parentSelector:function(){return document.querySelector("main")},children:Object(p.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault(),N.mutate(h),u(!1)}(e)},style:{minWidth:"300px"},children:[Object(p.jsxs)("div",{className:"input-field",children:[Object(p.jsx)("label",{htmlFor:"key",children:"Key"}),Object(p.jsx)("input",{type:"text",id:"key",value:h.key,disabled:!0})]}),Object(p.jsxs)("div",{className:"input-field",children:[Object(p.jsx)("label",{htmlFor:"Value",children:"Value"}),Object(p.jsx)("input",{type:"text",id:"value",value:h.value,ref:k,onChange:function(e){return function(e){e.preventDefault(),v({key:h.key,value:e.target.value})}(e)}})]}),Object(p.jsxs)("div",{className:"buttons-wrapper",children:[Object(p.jsxs)("button",{type:"submit",children:[Object(p.jsx)(b.h,{})," Submit"]}),Object(p.jsxs)("button",{onClick:function(e){e.preventDefault(),u(!1)},children:[Object(p.jsx)(b.i,{})," Cancel"]})]})]})})]})}V.a.setAppElement("#root");var D=n(82),M=n.n(D),P=(n(139),M()("http://localhost:4002"));function L(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),s=Object(o.a)(a,2),i=s[0],l=s[1],j=Object(c.useCallback)((function(){P.on("on-app-contrller-result",(function(e,t){console.log("on-app-contrller-result msg, cmd ",e,t),!e&&t.includes("restart")&&(e="Successfully restarted."),r(e),l(!1)}))}),[]);return Object(c.useEffect)((function(){return j(),function(){P.removeListener("on-app-contrller-result")}}),[]),Object(p.jsxs)("div",{className:"page-app-controller",children:[Object(p.jsx)("div",{className:"page-title",children:Object(p.jsx)("h1",{children:"App Controller"})}),Object(p.jsxs)("section",{children:[i&&Object(p.jsx)(C.a,{}),n&&Object(p.jsxs)("div",{className:"card warn",children:[Object(p.jsx)("span",{className:"inline-block",children:Object(p.jsx)(b.e,{})}),Object(p.jsx)("span",{className:"inline-block",children:n})]}),Object(p.jsx)("div",{className:"block",children:Object(p.jsx)("div",{className:"card",children:Object(p.jsxs)("button",{className:"action-text",onClick:function(){return e="pm2 restart local",console.log("> execAppController init"),l(!0),n&&r(null),P.emit("on-app-controller",e),void setTimeout((function(){l(!1)}),5e3);var e},children:[Object(p.jsx)("span",{className:"inline-block",children:Object(p.jsx)(b.g,{})}),Object(p.jsx)("span",{className:"inline-block",children:"Restart the app"})]})})})]})]})}var Q=new h.a,F=function(){return Object(p.jsxs)("main",{children:[Object(p.jsx)(f.a,{client:Q,children:Object(p.jsxs)(d.c,{children:[Object(p.jsx)(d.a,{exact:!0,component:E,path:"/"}),Object(p.jsx)(d.a,{exact:!0,component:L,path:"/app-controller"})]})}),Object(p.jsx)("footer",{children:Object(p.jsx)("small",{children:"\xa9 2021 Printingify"})})]})};var J=function(e){e.setLocale;var t=Object(c.useState)(!1),n=Object(o.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(!1),i=Object(o.a)(s,2),l=i[0],j=i[1];return Object(p.jsxs)("div",{className:"app ".concat(l?"toggled":""),children:[Object(p.jsx)(O,{collapsed:r,toggled:l,handleToggleSidebar:function(e){console.log("handleToggleSidebar value",e),j(e)},handleCollapsedChange:function(e){a((function(){return e=!e}))}}),Object(p.jsx)(F,{})]})},R={en:{title:"Printingify",sidebarTitle:"Printingify",description:"All about Printing",dashboard:"Dashboard",configVars:"Config Vars",appController:"App Controller",new:"New"}};n(140);var q=function(){var e=Object(c.useState)("en"),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(p.jsx)(l.a,{locale:n,messages:R[n],children:Object(p.jsx)(i.a,{children:Object(p.jsx)(J,{setLocale:r})})})};s.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(q,{})}),document.getElementById("root"))}},[[141,1,2]]]);
//# sourceMappingURL=main.7b6dc734.chunk.js.map